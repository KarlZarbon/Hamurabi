export default class Terminal{constructor(t,e,i,r,s,h,u){this.x=e,this.y=i,this.width=r,this.height=s,this.screen=t.createGraphics(r,s),this.backgroundColor=h,this.currentY=0,this.textBuffer=[],this.currentTextBufferIdx=0,this.textBufferMaxSize=u,this.userInput="",this.initTextBuffer(),this.initScreen(t),this.eol=!1}initTextBuffer(){this.fontHeight=Math.floor(this.height/this.textBufferMaxSize)-1;for(let t=0;t<this.textBufferMaxSize;t++)this.textBuffer[t]=""}initScreen(t){this.screen.background(this.backgroundColor),this.screen.textAlign(t.LEFT,t.TOP);this.screen.textSize(.85*this.fontHeight),this.screen.textFont("Courier New"),this.screen.fill(255),this.leftMargin=3,this.topMargin=3,this.prompt=""}show(t){this.buildOffscreenBuffer(),t.image(this.screen,this.x,this.y)}getTextBuffer(t){return this.textBuffer[t%this.textBuffer.length]}setTextBuffer(t,e){this.textBuffer[t%this.textBuffer.length]=e}scroll(){this.currentY+=this.fontHeight}lineReturn(){this.currentTextBufferIdx++,this.clearInputLine()}clearInputLine(){this.setTextBuffer(this.currentTextBufferIdx,""),this.userInput=""}updateBuffer(t){this.setTextBuffer(this.currentTextBufferIdx,t)}addText(t){this.updateBuffer(t),this.lineReturn()}getInput(){return this.eol=!1,this.getTextBuffer(this.currentTextBufferIdx-1)}isReturn(){return this.eol}buildOffscreenBuffer(){let t=this.currentTextBufferIdx+1;this.screen.background(this.backgroundColor),this.currentY=0;for(let e=0;e<this.textBuffer.length;e++){this.prompt=t%this.textBuffer.length+" > ";let e=this.prompt+this.getTextBuffer(t++);this.screen.text(e,this.leftMargin,this.topMargin+this.currentY),this.scroll()}}processKeyPressed(t,e,i){this.eol=!1,e>="0"&&e<="9"||"-"==e?this.userInput+=e:i===t.RETURN?(this.eol=!0,this.lineReturn()):i===t.BACKSPACE&&(this.userInput=this.userInput.slice(0,-1)),this.updateBuffer(this.userInput)}};